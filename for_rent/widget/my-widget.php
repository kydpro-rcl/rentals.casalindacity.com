<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">

<head>
<title>Source for my-widget.php</title>
</head>

<body>
<code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #FF8000">/*<br />Plugin&nbsp;Name:&nbsp;My&nbsp;Widget<br />Plugin&nbsp;URI:&nbsp;http://guff.szub.net/my-widget-example-wordpress-widget<br />Description:&nbsp;Example&nbsp;sidebar&nbsp;widget.&nbsp;Source&nbsp;sports&nbsp;lots&nbsp;of&nbsp;commenting.&nbsp;Hello&nbsp;World!<br />Author:&nbsp;Kaf&nbsp;Oseo<br />Version:&nbsp;Demo<br />Author&nbsp;URI:&nbsp;http://szub.net<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;My&nbsp;Widget&nbsp;is&nbsp;released&nbsp;under&nbsp;the&nbsp;GNU&nbsp;General&nbsp;Public&nbsp;License&nbsp;(GPL)<br />&nbsp;&nbsp;&nbsp;&nbsp;http://www.gnu.org/licenses/gpl.txt<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;This&nbsp;is&nbsp;a&nbsp;WordPress&nbsp;plugin&nbsp;(http://wordpress.org)&nbsp;and&nbsp;widget<br />&nbsp;&nbsp;&nbsp;&nbsp;(http://automattic.com/code/widgets/).<br />*/<br /><br />//&nbsp;We're&nbsp;putting&nbsp;the&nbsp;plugin's&nbsp;functions&nbsp;in&nbsp;one&nbsp;big&nbsp;function&nbsp;we&nbsp;then<br />//&nbsp;call&nbsp;at&nbsp;'plugins_loaded'&nbsp;(add_action()&nbsp;at&nbsp;bottom)&nbsp;to&nbsp;ensure&nbsp;the<br />//&nbsp;required&nbsp;Sidebar&nbsp;Widget&nbsp;functions&nbsp;are&nbsp;available.<br /></span><span style="color: #007700">function&nbsp;</span><span style="color: #0000BB">widget_mywidget_init</span><span style="color: #007700">()&nbsp;{<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;Check&nbsp;to&nbsp;see&nbsp;required&nbsp;Widget&nbsp;API&nbsp;functions&nbsp;are&nbsp;defined...<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if&nbsp;(&nbsp;!</span><span style="color: #0000BB">function_exists</span><span style="color: #007700">(</span><span style="color: #DD0000">'register_sidebar_widget'</span><span style="color: #007700">)&nbsp;||&nbsp;!</span><span style="color: #0000BB">function_exists</span><span style="color: #007700">(</span><span style="color: #DD0000">'register_widget_control'</span><span style="color: #007700">)&nbsp;)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;&nbsp;</span><span style="color: #FF8000">//&nbsp;...and&nbsp;if&nbsp;not,&nbsp;exit&nbsp;gracefully&nbsp;from&nbsp;the&nbsp;script.<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;This&nbsp;function&nbsp;prints&nbsp;the&nbsp;sidebar&nbsp;widget--the&nbsp;cool&nbsp;stuff!<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">function&nbsp;</span><span style="color: #0000BB">widget_mywidget</span><span style="color: #007700">(</span><span style="color: #0000BB">$args</span><span style="color: #007700">)&nbsp;{<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;$args&nbsp;is&nbsp;an&nbsp;array&nbsp;of&nbsp;strings&nbsp;which&nbsp;help&nbsp;your&nbsp;widget<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;conform&nbsp;to&nbsp;the&nbsp;active&nbsp;theme:&nbsp;before_widget,&nbsp;before_title,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;after_widget,&nbsp;and&nbsp;after_title&nbsp;are&nbsp;the&nbsp;array&nbsp;keys.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">extract</span><span style="color: #007700">(</span><span style="color: #0000BB">$args</span><span style="color: #007700">);<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;Collect&nbsp;our&nbsp;widget's&nbsp;options,&nbsp;or&nbsp;define&nbsp;their&nbsp;defaults.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$options&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">get_option</span><span style="color: #007700">(</span><span style="color: #DD0000">'widget_mywidget'</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$title&nbsp;</span><span style="color: #007700">=&nbsp;empty(</span><span style="color: #0000BB">$options</span><span style="color: #007700">[</span><span style="color: #DD0000">'title'</span><span style="color: #007700">])&nbsp;?&nbsp;</span><span style="color: #DD0000">'My&nbsp;Widget'&nbsp;</span><span style="color: #007700">:&nbsp;</span><span style="color: #0000BB">$options</span><span style="color: #007700">[</span><span style="color: #DD0000">'title'</span><span style="color: #007700">];<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$text&nbsp;</span><span style="color: #007700">=&nbsp;empty(</span><span style="color: #0000BB">$options</span><span style="color: #007700">[</span><span style="color: #DD0000">'text'</span><span style="color: #007700">])&nbsp;?&nbsp;</span><span style="color: #DD0000">'Hello&nbsp;World!'&nbsp;</span><span style="color: #007700">:&nbsp;</span><span style="color: #0000BB">$options</span><span style="color: #007700">[</span><span style="color: #DD0000">'text'</span><span style="color: #007700">];<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;It's&nbsp;important&nbsp;to&nbsp;use&nbsp;the&nbsp;$before_widget,&nbsp;$before_title,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;$after_title&nbsp;and&nbsp;$after_widget&nbsp;variables&nbsp;in&nbsp;your&nbsp;output.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">$before_widget</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #0000BB">$before_title&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">$title&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">$after_title</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #0000BB">$text</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #0000BB">$after_widget</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;This&nbsp;is&nbsp;the&nbsp;function&nbsp;that&nbsp;outputs&nbsp;the&nbsp;form&nbsp;to&nbsp;let&nbsp;users&nbsp;edit<br />&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;the&nbsp;widget's&nbsp;title&nbsp;and&nbsp;so&nbsp;on.&nbsp;It's&nbsp;an&nbsp;optional&nbsp;feature,&nbsp;but<br />&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;we'll&nbsp;use&nbsp;it&nbsp;because&nbsp;we&nbsp;can!<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">function&nbsp;</span><span style="color: #0000BB">widget_mywidget_control</span><span style="color: #007700">()&nbsp;{<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;Collect&nbsp;our&nbsp;widget's&nbsp;options.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$options&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">get_option</span><span style="color: #007700">(</span><span style="color: #DD0000">'widget_mywidget'</span><span style="color: #007700">);<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;This&nbsp;is&nbsp;for&nbsp;handing&nbsp;the&nbsp;control&nbsp;form&nbsp;submission.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if&nbsp;(&nbsp;</span><span style="color: #0000BB">$_POST</span><span style="color: #007700">[</span><span style="color: #DD0000">'mywidget-submit'</span><span style="color: #007700">]&nbsp;)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;Clean&nbsp;up&nbsp;control&nbsp;form&nbsp;submission&nbsp;options<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$newoptions</span><span style="color: #007700">[</span><span style="color: #DD0000">'title'</span><span style="color: #007700">]&nbsp;=&nbsp;</span><span style="color: #0000BB">strip_tags</span><span style="color: #007700">(</span><span style="color: #0000BB">stripslashes</span><span style="color: #007700">(</span><span style="color: #0000BB">$_POST</span><span style="color: #007700">[</span><span style="color: #DD0000">'mywidget-title'</span><span style="color: #007700">]));<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$newoptions</span><span style="color: #007700">[</span><span style="color: #DD0000">'text'</span><span style="color: #007700">]&nbsp;=&nbsp;</span><span style="color: #0000BB">strip_tags</span><span style="color: #007700">(</span><span style="color: #0000BB">stripslashes</span><span style="color: #007700">(</span><span style="color: #0000BB">$_POST</span><span style="color: #007700">[</span><span style="color: #DD0000">'mywidget-text'</span><span style="color: #007700">]));<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;If&nbsp;original&nbsp;widget&nbsp;options&nbsp;do&nbsp;not&nbsp;match&nbsp;control&nbsp;form<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;submission&nbsp;options,&nbsp;update&nbsp;them.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if&nbsp;(&nbsp;</span><span style="color: #0000BB">$options&nbsp;</span><span style="color: #007700">!=&nbsp;</span><span style="color: #0000BB">$newoptions&nbsp;</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$options&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$newoptions</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">update_option</span><span style="color: #007700">(</span><span style="color: #DD0000">'widget_mywidget'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$options</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;Format&nbsp;options&nbsp;as&nbsp;valid&nbsp;HTML.&nbsp;Hey,&nbsp;why&nbsp;not.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$title&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">htmlspecialchars</span><span style="color: #007700">(</span><span style="color: #0000BB">$options</span><span style="color: #007700">[</span><span style="color: #DD0000">'title'</span><span style="color: #007700">],&nbsp;</span><span style="color: #0000BB">ENT_QUOTES</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$text&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">htmlspecialchars</span><span style="color: #007700">(</span><span style="color: #0000BB">$options</span><span style="color: #007700">[</span><span style="color: #DD0000">'text'</span><span style="color: #007700">],&nbsp;</span><span style="color: #0000BB">ENT_QUOTES</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">//&nbsp;The&nbsp;HTML&nbsp;below&nbsp;is&nbsp;the&nbsp;control&nbsp;form&nbsp;for&nbsp;editing&nbsp;options.<br /></span><span style="color: #0000BB">?&gt;<br /></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;label&nbsp;for="mywidget-title"&nbsp;style="line-height:35px;display:block;"&gt;Widget&nbsp;title:&nbsp;&lt;input&nbsp;type="text"&nbsp;id="mywidget-title"&nbsp;name="mywidget-title"&nbsp;value="<span style="color: #0000BB">&lt;?php&nbsp;</span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">$title</span><span style="color: #007700">;&nbsp;</span><span style="color: #0000BB">?&gt;</span>"&nbsp;/&gt;&lt;/label&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;label&nbsp;for="mywidget-text"&nbsp;style="line-height:35px;display:block;"&gt;Widget&nbsp;text:&nbsp;&lt;input&nbsp;type="text"&nbsp;id="mywidget-text"&nbsp;name="mywidget-text"&nbsp;value="<span style="color: #0000BB">&lt;?php&nbsp;</span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">$text</span><span style="color: #007700">;&nbsp;</span><span style="color: #0000BB">?&gt;</span>"&nbsp;/&gt;&lt;/label&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;input&nbsp;type="hidden"&nbsp;name="mywidget-submit"&nbsp;id="mywidget-submit"&nbsp;value="1"&nbsp;/&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #0000BB">&lt;?php<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;end&nbsp;of&nbsp;widget_mywidget_control()<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;This&nbsp;registers&nbsp;the&nbsp;widget.&nbsp;About&nbsp;time.<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">register_sidebar_widget</span><span style="color: #007700">(</span><span style="color: #DD0000">'My&nbsp;Widget'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'widget_mywidget'</span><span style="color: #007700">);<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;This&nbsp;registers&nbsp;the&nbsp;(optional!)&nbsp;widget&nbsp;control&nbsp;form.<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">register_widget_control</span><span style="color: #007700">(</span><span style="color: #DD0000">'My&nbsp;Widget'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'widget_mywidget_control'</span><span style="color: #007700">);<br />}<br /><br /></span><span style="color: #FF8000">//&nbsp;Delays&nbsp;plugin&nbsp;execution&nbsp;until&nbsp;Dynamic&nbsp;Sidebar&nbsp;has&nbsp;loaded&nbsp;first.<br /></span><span style="color: #0000BB">add_action</span><span style="color: #007700">(</span><span style="color: #DD0000">'plugins_loaded'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'widget_mywidget_init'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></body>
</html>

